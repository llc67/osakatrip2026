<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026å¤§é˜ª Â· å¾‹ç¶º</title>
    <style>
        :root { --primary: #3b71ca; --bg: #f8f9fa; --text: #202124; --nav-blue: #1a73e8; }
        body { font-family: -apple-system, "Noto Sans TC", sans-serif; background: var(--bg); margin: 0; color: var(--text); padding-bottom: 30px; }
        
        .tabs { display: flex; background: white; position: sticky; top: 0; z-index: 100; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .tab-btn { flex: 1; padding: 15px; border: none; background: none; font-size: 1rem; font-weight: bold; color: #5f6368; cursor: pointer; }
        .tab-btn.active { color: var(--nav-blue); border-bottom: 3px solid var(--nav-blue); }
        
        .content-section { display: none; padding: 15px; }
        .content-section.active { display: block; }

        .day-header { display: flex; align-items: center; justify-content: space-between; margin: 15px 0; }
        .day-info { display: flex; align-items: center; gap: 10px; }
        .day-badge { background: var(--primary); color: white; padding: 4px 12px; border-radius: 6px; font-weight: bold; font-size: 1.1rem; }
        .day-date { font-size: 1.15rem; font-weight: bold; color: #3c4043; outline: none; }

        .event-card { background: white; border-radius: 12px; padding: 18px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #dadce0; border-left: 5px solid var(--primary); position: relative; }
        .card-del { position: absolute; top: 10px; right: 10px; color: #ccc; cursor: pointer; border: none; background: none; font-size: 1.2rem; }
        
        .event-time { color: var(--nav-blue); font-size: 1.25rem; font-weight: bold; margin-bottom: 8px; outline: none; display: inline-block; min-width: 50px; }
        .event-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 8px; color: #202124; outline: none; display: block; }
        .event-detail { font-size: 1rem; color: #5f6368; outline: none; white-space: pre-wrap; line-height: 1.6; min-height: 20px; }

        .add-card-btn { background: white; border: 1px dashed var(--primary); color: var(--primary); border-radius: 8px; width: 100%; padding: 12px; margin-bottom: 25px; font-weight: bold; cursor: pointer; font-size: 1rem; }

        .info-card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid #dadce0; }
        .info-title { font-weight: bold; color: var(--nav-blue); margin-bottom: 12px; font-size: 1.1rem; }
        .calc-box { display: flex; align-items: center; gap: 10px; background: #f8f9fa; padding: 15px; border-radius: 8px; }
        .calc-input { flex: 1; padding: 10px; border: 1px solid #dadce0; border-radius: 8px; font-size: 1.1rem; width: 100px; }
        .todo-item { display: flex; align-items: center; gap: 12px; padding: 12px 0; border-bottom: 1px solid #f1f3f4; }
    </style>
</head>
<body>

<div class="tabs">
    <button class="tab-btn active" onclick="openTab('daily')">ğŸ“… æ¯æ—¥è¡Œç¨‹</button>
    <button class="tab-btn" onclick="openTab('info')">ğŸ›ï¸ è³‡è¨Š & è³¼ç‰©</button>
</div>

<div id="daily" class="content-section active">
    <div id="itinerary-list"></div>
</div>

<div id="info" class="content-section">
    <div class="info-card">
        <div class="info-title">ğŸ’´ åŒ¯ç‡æ›ç®— (JPY â¡ï¸ TWD)</div>
        <div class="calc-box">
            <input type="number" id="jpyInput" class="calc-input" placeholder="æ—¥å¹£" oninput="convert()">
            <span style="font-weight:bold">â¡ï¸</span>
            <div id="twdRes" style="font-size: 1.2rem; font-weight: bold; color: #188038;">å°å¹£ $0</div>
        </div>
    </div>
    <div class="info-card">
        <div class="info-title">ğŸ“‹ è³¼ç‰©èˆ‡ç¾é£Ÿå¾…è¾¦</div>
        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <input type="text" id="todo-in" style="flex:1; padding:12px; border:1px solid #dadce0; border-radius:10px;" placeholder="è²·è­·è‰²æ´—é«®ç²¾...">
            <button onclick="addT()" style="background:var(--nav-blue); color:white; border:none; border-radius:10px; padding:0 20px; font-weight:bold;">æ–°å¢</button>
        </div>
        <div id="t-list"></div>
    </div>
</div>

<script>
    const defaultData = [
        { badge: "Day 1", date: "2/20 (äº”) æŠµé” ãƒ» å¿ƒé½‹æ©‹", events: [
            { time: "11:55", title: "æŠµé”é—œè¥¿æ©Ÿå ´ (KIX)", detail: "â€¢ èˆªç­ï¼šé•·æ¦® BR132 (08:20 èµ·é£›)\nâ€¢ ä»»å‹™ï¼šå…¥å¢ƒã€é ˜è¡Œæã€åŠƒä½ JR\nâ€¢ äº¤é€šï¼šæ­ä¹˜ HARUKA JR å‰å¾€å¤§é˜ª" },
            { time: "15:00", title: "é£¯åº— Check-in", detail: "â€¢ åœ°é»ï¼šApartment hotel 11 umeda" },
            { time: "16:30", title: "å¿ƒé½‹æ©‹ ãƒ» é“é “å €", detail: "â€¢ è¡Œç¨‹ï¼šå•†åº—è¡—é€›é€›ã€å›ºåŠ›æœäººæ‹ç…§\nâ€¢ æ™šé¤ï¼šå¤§é˜ªç‡’æˆ–ç« é­šç‡’" }
        ]},
        { badge: "Day 2", date: "2/21 (å…­) é ˜ç‰©è³‡ ãƒ» æ¢…ç”°", events: [
            { time: "å…¨å¤©", title: "INTEX Osaka å ±åˆ°", detail: "â€¢ ä»»å‹™ï¼šé ˜å–é¦¬æ‹‰æ¾ç‰©è³‡\nâ€¢ æ™šé¤ï¼šæ¢…ç”°é™„è¿‘ç”¨é¤ (ã—ã‚“ã±ã¡é£Ÿå ‚)" }
        ]},
        { badge: "Day 3", date: "2/22 (æ—¥) é¦¬æ‹‰æ¾åŠ æ²¹æ—¥", events: [
            { time: "æ—©ä¸Š", title: "é¦¬æ‹‰æ¾åŠ æ²¹åœ˜", detail: "â€¢ ä»»å‹™ï¼šè·Ÿåª½åª½å»åŠ æ²¹ï¼Œä¸­åˆæœƒåˆ\nâ€¢ ä¸‹åˆï¼šé£¯åº—ä¼‘æ¯ï¼Œæ¢…ç”°é€›é€›" }
        ]},
        { badge: "Day 4", date: "2/23 (ä¸€) å¤©æ©‹ç«‹ä¸€æ—¥éŠ", events: [
            { time: "å…¨å¤©", title: "å¤©æ©‹ç«‹è‡ªåŠ©è¡Œ", detail: "â€¢ äº¤é€šï¼šJR ä¸¹å¾Œéµé“ä¸€æ—¥éŠ (ä¸è·Ÿåœ˜)" }
        ]},
        { badge: "Day 5", date: "2/24 (äºŒ) å¸‚å ´èˆ‡ç¥ç¤¾", events: [
            { time: "æ—©ä¸Š", title: "æœ¨æ´¥å¸‚å ´", detail: "â€¢ æ¨è–¦ï¼šé®®é­š é­šè± (é°»é­šé£¯)" },
            { time: "ä¸­åˆ", title: "é›£æ³¢å…«é˜ªç¥ç¤¾", detail: "â€¢ è¡Œç¨‹ï¼šç…å­é ­æ®¿æ‹ç…§ã€æ±‚å‹é‹\nâ€¢ å‚™æ¡ˆï¼šå‹å°¾å¯º" }
        ]},
        { badge: "Day 6", date: "2/25 (ä¸‰) æœ€å¾Œæ¡è²· ãƒ» å›ç¨‹", events: [
            { time: "ä¸Šåˆ", title: "è‡¨ç©ºåŸ Outlet", detail: "â€¢ è¡Œç¨‹ï¼šæœ€å¾Œè£œè²¨æ¡è²·" },
            { time: "18:10", title: "é£›æ©Ÿèµ·é£› âœˆï¸", detail: "â€¢ èˆªç­ï¼šé•·æ¦® BR131\nâ€¢ é è¨ˆï¼š20:25 æŠµé”å°ç£" }
        ]}
    ];

    let itinData = JSON.parse(localStorage.getItem('osaka_v7_itin')) || defaultData;
    let todos = JSON.parse(localStorage.getItem('osaka_v7_todos')) || [];

    function openTab(tId) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tId).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function save() {
        localStorage.setItem('osaka_v7_itin', JSON.stringify(itinData));
        localStorage.setItem('osaka_v7_todos', JSON.stringify(todos));
    }

    function renderItin() {
        document.getElementById('itinerary-list').innerHTML = itinData.map((day, dIdx) => `
            <div class="day-header">
                <div class="day-info">
                    <span class="day-badge">${day.badge}</span>
                    <span class="day-date" contenteditable="true" onblur="itinData[${dIdx}].date=this.innerText;save()">${day.date}</span>
                </div>
            </div>
            ${day.events.map((ev, eIdx) => `
                <div class="event-card">
                    <button class="card-del" onclick="removeEvent(${dIdx}, ${eIdx})">Ã—</button>
                    <div class="event-time" contenteditable="true" onblur="itinData[${dIdx}].events[${eIdx}].time=this.innerText;save()">${ev.time}</div>
                    <div class="event-title" contenteditable="true" onblur="itinData[${dIdx}].events[${eIdx}].title=this.innerText;save()">${ev.title}</div>
                    <div class="event-detail" contenteditable="true" onblur="itinData[${dIdx}].events[${eIdx}].detail=this.innerText;save()">${ev.detail}</div>
                </div>
            `).join('')}
            <button class="add-card-btn" onclick="addEvent(${dIdx})">+ æ–°å¢è¡Œç¨‹å¡ç‰‡</button>
        `).join('');
    }

    window.addEvent = (dIdx) => {
        itinData[dIdx].events.push({ time: "æ™‚é–“", title: "é»æ“Šç·¨è¼¯è¡Œç¨‹", detail: "â€¢ è©³ç´°ä»»å‹™" });
        save(); renderItin();
    };

    window.removeEvent = (dIdx, eIdx) => {
        if(confirm("ç¢ºå®šåˆªé™¤æ­¤è¡Œç¨‹ï¼Ÿ")) { itinData[dIdx].events.splice(eIdx, 1); save(); renderItin(); }
    };

    function convert() {
        const j = document.getElementById('jpyInput').value;
        document.getElementById('twdRes').innerText = "å°å¹£ $" + Math.round(j * 0.21);
    }

    function addT() {
        const i = document.getElementById('todo-in');
        if(i.value){ todos.push({txt:i.value, d:false}); i.value=''; save(); renderT(); }
    }

    function renderT() {
        document.getElementById('t-list').innerHTML = todos.map((t, i) => `
            <div class="todo-item">
                <input type="checkbox" ${t.d?'checked':''} onclick="todos[${i}].d=!todos[${i}].d;save();renderT();">
                <span style="${t.d?'text-decoration:line-through;color:#9aa0a6':''}">${t.txt}</span>
                <button onclick="todos.splice(${i},1);save();renderT();" style="margin-left:auto;border:none;background:none;color:#d93025;font-size:1.2rem;">Ã—</button>
            </div>`).join('');
    }

    window.onload = () => { renderItin(); renderT(); };
</script>
</body>
</html>
